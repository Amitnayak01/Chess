<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Chess Game</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.1/socket.io.js"></script>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="container">
    <!-- Game Setup Screen -->
    <section id="game-setup" class="game-setup">
      <h2>Join or Create a Game</h2>
      
      <input type="text" id="player-name" class="input-group" placeholder="Enter your name" maxlength="20">
      
      <div class="input-group">
        <label for="timer-duration">Game Timer:</label>
        <select id="timer-duration">
          <!-- <option value="10">10 sec</option> -->
          <option value="180">3 Minutes</option>
          <option value="300">5 Minutes</option>
          <option value="600">10 Minutes</option>
          <option value="900">15 Minutes</option>
          <option value="1800">30 Minutes</option>
        </select>
      </div>
      
      <button class="btn-primary input-group" onclick="createGame()">Create New Game</button>
      
      <div class="input-group">
        <input type="text" id="game-id-input" placeholder="Enter Game ID" maxlength="8">
        <button class="btn-secondary" onclick="joinGame()">Join Game</button>
      </div>
      
      <div id="room-list" class="room-list">
        <h3>Available Games</h3>
        <p>Loading games...</p>
      </div>
    </section>

    <!-- Main Game Interface -->
    <section id="game-interface" class="game-interface">
      <!-- Game Info Panel -->
      <aside class="game-info">
        <h3>Game ID</h3>
        <p id="game-id-display" class="game-id-display">----</p>
        
        <!-- Players Section -->
        <div id="players-list">
          <div class="player-info white-player">
            <span class="chess-piece">‚ôî</span>
            White: <span id="white-player-name" class="waiting">Waiting...</span>
          </div>
          <div class="player-info black-player">
            <span class="chess-piece">‚ôõ</span>
            Black: <span id="black-player-name" class="waiting">Waiting...</span>
          </div>
          <div id="spectators-section" style="display: none;">
            <h4>Spectators:</h4>
            <div id="spectators-list"></div>
          </div>
        </div>
        
        <div id="game-status" class="status"></div>
      </aside>

      <!-- Game Board & Timers -->
      <main class="game-board-container">
        <!-- Move History -->
        <div id="move-history-container">
          <div id="move-list" class="move-list-horizontal move-history-content"></div>
        </div>

        <!-- White Timer & Captured Pieces -->
        <div class="timer-item white-timer">
          <span class="timer-label">
            ‚ö™ <strong>White:</strong> <span id="captured-white"></span>
          </span>
          <span id="white-timer" class="timer-value">--:--</span>
        </div>

        <!-- Chess Board -->
        <div id="chessboard" class="chessboard"></div>

        <!-- Black Timer & Captured Pieces -->
        <div class="timer-item black-timer">
          <span class="timer-label">
            ‚ö´ <strong>Black:</strong> <span id="captured-black"></span>
          </span>
          <span id="black-timer" class="timer-value">--:--</span>
        </div>
      </main>

      <!-- Controls & Navigation -->
      <nav class="navigation-controls">
        <!-- Hamburger Menu -->
        <button class="hamburger-menu" id="hamburger-btn">
          <div class="hamburger-bar"></div>
          <div class="hamburger-bar"></div>
          <div class="hamburger-bar"></div>
        </button>

        <!-- Navigation Buttons -->
        <button id="back-button">‚Üê</button>
        <button id="forward-button">‚Üí</button>
        <button id="live-button">Live</button>
        <button id="dark-mode-btn">üåô Dark</button>

        <!-- Chat Toggle -->
        <div class="chat-icon" onclick="toggleChat()">
          <svg viewBox="0 0 24 24">
            <path d="M20,2H4A2,2 0 0,0 2,4V22L6,18H20A2,2 0 0,0 22,16V4C22,2.89 21.1,2 20,2Z"/>
          </svg>
          <div id="notification-badge" class="notification-badge">0</div>
        </div>
      </nav>

      <!-- Chat Section -->
      <section id="chat-container" class="chat-section">
        <h3>
          Chat
          <button class="close-chat" onclick="toggleChat()">√ó</button>
        </h3>
        <div id="chat-messages" class="chat-messages"></div>
        <div class="chat-input-container">
          <input type="text" id="chat-input" class="chat-input" placeholder="Type a message..." maxlength="200">
          <button class="btn-primary" onclick="sendChatMessage()">Send</button>
        </div>
      </section>
    </section>

    <!-- Popup Overlay for Game Controls -->
    <div class="popup-overlay" id="popup-overlay">
      <div class="popup-content">
        <button class="close-popup" onclick="closePopup()">&times;</button>
        <div class="popup-title">Game Controls</div>
        <div class="game-controls">
          <button class="btn-secondary" onclick="showSetupInterface()">Leave Game</button>
          <button id="draw-button" onclick="offerDraw()">Offer Draw</button>
        </div>
      </div>
    </div>

    <!-- Promotion Modal -->
    <div id="promotion-modal" class="promotion-modal">
      <div class="promotion-content">
        <h3>Choose Promotion Piece</h3>
        <div id="promotion-options" class="promotion-options"></div>
      </div>
    </div>
  </div>

  <!-- JavaScript -->
  <script>
    const hamburgerBtn = document.getElementById('hamburger-btn');
    const popupOverlay = document.getElementById('popup-overlay');
    const darkModeBtn = document.getElementById('dark-mode-btn');

    // Toggle popup
    hamburgerBtn.addEventListener('click', () => {
      hamburgerBtn.classList.toggle('active');
      popupOverlay.classList.toggle('show');
    });

    // Close popup when clicking outside
    popupOverlay.addEventListener('click', e => {
      if (e.target === popupOverlay) closePopup();
    });

    function closePopup() {
      hamburgerBtn.classList.remove('active');
      popupOverlay.classList.remove('show');
    }

    function showSetupInterface() {
      alert('Leaving game...');
      closePopup();
    }

    function offerDraw() {
      alert('Draw offer sent!');
      closePopup();
    }

    // Close popup with Escape key
    document.addEventListener('keydown', e => {
      if (e.key === 'Escape' && popupOverlay.classList.contains('show')) {
        closePopup();
      }
    });

    // Dark Mode Toggle
    darkModeBtn.addEventListener('click', () => {
      document.body.classList.toggle('dark-mode');
      darkModeBtn.textContent = document.body.classList.contains('dark-mode')
        ? "‚òÄÔ∏è Light"
        : "üåô Dark";
    });
  </script>

  <script src="script.js"></script>
  <script src="move.js"></script>
  <script src="move2.js"></script>
  <script src="timer.js"></script>
  <script src="chat.js"></script>
  <script src="draw.js"></script>
  <script src="exit.js"></script>
  <script src="announce.js"></script>
</body>
</html>